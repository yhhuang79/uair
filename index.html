<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
    <meta name="author" content="Power by GeeksLabs" />
    <link rel="shortcut icon" href="img/favicon.png" >

    <title>TaiwanAir - Taiwan Urban Air Quilty Observe Dashboard</title>

    <!-- Bootstrap CSS -->
    <link href="css/bootstrap.min.css" rel="stylesheet">
    <!-- bootstrap theme -->
    <link href="css/bootstrap-theme.css" rel="stylesheet">
    <!--external css-->
    <!-- font icon -->
    <link href="css/elegant-icons-style.css" rel="stylesheet" />
    <link href="css/font-awesome.min.css" rel="stylesheet" />
    <!-- full calendar css-->
    <link href="assets/fullcalendar/fullcalendar/bootstrap-fullcalendar.css" rel="stylesheet" />
	  <link href="assets/fullcalendar/fullcalendar/fullcalendar.css" rel="stylesheet" />
    <!-- easy pie chart-->
    <link href="assets/jquery-easy-pie-chart/jquery.easy-pie-chart.css" rel="stylesheet" type="text/css" media="screen"/>
    <!-- owl carousel -->
    <!-- <link rel="stylesheet" href="css/owl.carousel.css" type="text/css">
	  <link href="css/jquery-jvectormap-1.2.2.css" rel="stylesheet"> -->
    <!-- leaflet map -->
    <link rel="stylesheet" href="http://cdn.leafletjs.com/leaflet-0.7.3/leaflet.css">
    <link rel="stylesheet" href="http://api.tiles.mapbox.com/mapbox.js/plugins/leaflet-markercluster/v0.4.0/MarkerCluster.css">
    <link rel="stylesheet" href="http://api.tiles.mapbox.com/mapbox.js/plugins/leaflet-markercluster/v0.4.0/MarkerCluster.Default.css">
    <link rel="stylesheet" href="http://api.tiles.mapbox.com/mapbox.js/plugins/leaflet-locatecontrol/v0.24.0/L.Control.Locate.css">
    <link rel="stylesheet" href="assets/leaflet-groupedlayercontrol/leaflet.groupedlayercontrol.css">
    <link rel="stylesheet" href="css/easy-button.css">

    <!-- Custom styles -->
	  <link rel="stylesheet" href="css/fullcalendar.css">
	  <link href="css/widgets.css" rel="stylesheet">
    <link href="css/style.css" rel="stylesheet">
    <link href="css/style-responsive.css" rel="stylesheet" />
	  <link href="css/xcharts.min.css" rel=" stylesheet">
	  <link href="css/jquery-ui-1.10.4.min.css" rel="stylesheet">
    <!-- HTML5 shim and Respond.js IE8 support of HTML5 -->
    <!--[if lt IE 9]>
      <script src="js/html5shiv.js"></script>
      <script src="js/respond.min.js"></script>
      <script src="js/lte-ie7.js"></script>
    <![endif]-->
  </head>

  <body>
  <!-- container section start -->
  <section id="container" class="">


      <header class="header dark-bg">
            <div class="toggle-nav">
                <div class="icon-reorder tooltips" data-original-title="Toggle Navigation" data-placement="bottom"></div>
            </div>

            <!--logo start-->
            <a href="index.html" class="logo">TAIWAN <span class="lite">Air</span></a>
            <!--logo end-->

            <div class="nav search-row" id="top_menu">
                <!--  search form start -->
                <ul class="nav top-menu">
                    <li>
                        <form class="navbar-form">
                            <input class="form-control" placeholder="Search" type="text">
                        </form>
                    </li>
                </ul>
                <!--  search form end -->
            </div>
      </header>
      <!--header end-->

      <!--sidebar start-->
      <aside>
          <div id="sidebar"  class="nav-collapse ">
              <!-- sidebar menu start-->
              <ul class="sidebar-menu">
                  <li class="active">
                      <a class="" href="index.html">
                          <i class="icon_house_alt"></i>
                          <span>空氣品質</span>
                      </a>
                  </li>
                  <li>
                      <a class="" href="leaflet.html">
                          <i class="icon_map"></i>
                          <span>地圖顯示</span>
                      </a>
                  </li>
                  <li>
                      <a class="" href="tables.html">
                          <i class="icon_table"></i>
                          <span>資料表格</span>
                      </a>
                  </li>
                  <li class="sub-menu">
                      <a href="javascript:;" class="">
                          <i class="icon_document_alt"></i>
                          <span>測站統計圖表</span>
                          <span class="menu-arrow arrow_carrot-right"></span>
                      </a>
                      <ul class="sub" id="siteMenu">
                          <li><a class="" href="form_component.html">Form Elements</a></li>
                          <li><a class="" href="form_validation.html">Form Validation</a></li>
                      </ul>
                  </li>
                  <li>
                      <a class="" href="lassmap.html">
                          <span>LASS開源公益環境感測</span>
                      </a>
                  </li>
                  <!-- <li>
                     <img src="img/Logo-MOL.jpg" class="img-responsive" alt="Cinque Terre">
                  </li> -->
              </ul>
              <!-- sidebar menu end-->
          </div>
      </aside>
      <!--sidebar end-->

      <!--main content start-->
      <section id="main-content">
          <section class="wrapper">
              <!--overview start-->
			  <div class="row">
				<div class="col-lg-12">
					<h3 class="page-header" id="sitelocation"><i class="fa fa-laptop"></i> Dashboard</h3>
					<ol class="breadcrumb">
						<li><i class="fa fa-home"></i><a href="index.html">Home</a></li>
						<li><i class="fa fa-laptop"></i>空氣品質</li>
					</ol>
				</div>
			</div>

            <div class="row">
				<div class="col-lg-3 col-md-3 col-sm-12 col-xs-12">
					<div class="info-box lass-blue-bg">
						<div class="circle" id="box-PSI">-.--</div>
						<div class="title">PSI空氣污染指數</div>
					</div><!--/.info-box-->
				</div><!--/.col-->

				<div class="col-lg-3 col-md-3 col-sm-12 col-xs-12">
					<div class="info-box lass-blue-bg">
						<div class="circle" id="box-PM10">-.--</div>
						<div class="title">PM 10觀測值</div>
					</div><!--/.info-box-->
				</div><!--/.col-->

				<div class="col-lg-3 col-md-3 col-sm-12 col-xs-12">
					<div class="info-box lass-blue-bg">
						<div class="circle" id="box-PM25">-.--</div>
						<div class="title">PM 2.5觀測值</div>
					</div><!--/.info-box-->
				</div><!--/.col-->

				<div class="col-lg-3 col-md-3 col-sm-12 col-xs-12">
					<div class="info-box lass-blue-bg">
						<div class="circle" id="box-WBGT">-.--</div>
						<div class="title">WBGT熱危害指數</div>
					</div><!--/.info-box-->
				</div><!--/.col-->

			</div><!--/.row-->


           <div class="row">
		    <div class="col-lg-9 col-md-12">

					<div class="panel panel-default">
						<div class="panel-heading">
							<h2><i class="fa fa-map-marker red"></i><strong>觀測站地圖</strong></h2>
							<div class="panel-actions">
								<a href="index.html#" class="btn-setting"><i class="fa fa-rotate-right"></i></a>
								<a href="index.html#" class="btn-minimize"><i class="fa fa-chevron-up"></i></a>
								<a href="index.html#" class="btn-close"><i class="fa fa-times"></i></a>
							</div>
						</div>
						<div class="panel-body-map" id="map-container">
							<div id="map" style="height:380px;"></div>
						</div>

					</div>
				</div>
              <div class="col-md-3">
              <!-- List starts -->
				<ul class="today-datas">
                <!-- List #1 -->
				<li>
                  <!-- Graph -->
                  <div><span id="todayspark1" class="spark"></span></div>
                  <!-- Text -->
                  <div class="datas-text">PSI觀測值</div>
                </li>
                <li>
                  <div><span id="todayspark2" class="spark"></span></div>
                  <div class="datas-text">二氧化硫(SO<sub>2</sub>)觀測值</div>
                </li>
                <li>
                  <div><span id="todayspark3" class="spark"></span></div>
                  <div class="datas-text">一氧化碳(CO)觀測值</div>
                </li>
                <li>
                  <div><span id="todayspark4" class="spark"></span></div>
                  <div class="datas-text">臭氧(O<sub>3</sub>)觀測值</div>
                </li>
                <li>
                  <div><span id="todayspark5" class="spark"></span></div>
                  <div class="datas-text">二氧化氮(NO<sub>2</sub>)觀測值</div>
                </li>
              </ul>
              </div>


           </div>


		  <!-- Today status end -->



			<div class="row">

				<div class="col-lg-9 col-md-12">
					<div class="panel panel-default">
						<div class="panel-heading">
							<h2><i class="fa fa-flag-o red"></i><strong>觀測站列表</strong></h2>
							<div class="panel-actions">
								<a href="index.html#" class="btn-setting"><i class="fa fa-rotate-right"></i></a>
								<a href="index.html#" class="btn-minimize"><i class="fa fa-chevron-up"></i></a>
								<a href="index.html#" class="btn-close"><i class="fa fa-times"></i></a>
							</div>
						</div>
						<div class="panel-body">
							<table class="table bootstrap-datatable countries">
								<thead>
									<tr>
										<th></th>
										<th>觀測站</th>
										<th>PM 10</th>
										<th>PM 2.5</th>
										<th>空污指標</th>
									</tr>
								</thead>
								<tbody id=observeStationList>
									<!-- <tr>
										<td><img src="img/Germany.png" style="height:18px; margin-top:-2px;"></td>
										<td>Germany</td>
										<td>2563</td>
										<td>1025</td>
										<td>
											<div class="progress thin">
												<div class="progress-bar progress-bar-danger" role="progressbar" aria-valuenow="73" aria-valuemin="0" aria-valuemax="100" style="width: 73%">
												</div>
												<div class="progress-bar progress-bar-warning" role="progressbar" aria-valuenow="27" aria-valuemin="0" aria-valuemax="100" style="width: 27%">
											  	</div>
											</div>
											<span class="sr-only">73%</span>
										</td>
									</tr> -->
								</tbody>
							</table>
						</div>

					</div>

				</div><!--/col-->
				<div class="col-md-3">

					<div class="social-box facebook">
						<i class="fa fa-facebook"></i>
						<ul>
							<li>
								<strong>256k</strong>
								<span>friends</span>
							</li>
							<li>
								<strong>359</strong>
								<span>feeds</span>
							</li>
						</ul>
					</div><!--/social-box-->
				</div>
				<div class="col-md-3">

					<div class="social-box google-plus">
						<i class="fa fa-google-plus"></i>
						<ul>
							<li>
								<strong>962</strong>
								<span>followers</span>
							</li>
							<li>
								<strong>256</strong>
								<span>circles</span>
							</li>
						</ul>
					</div><!--/social-box-->

				</div><!--/col-->
				<div class="col-md-3">

					<div class="social-box twitter">
						<i class="fa fa-twitter"></i>
						<ul>
							<li>
								<strong>1562k</strong>
								<span>followers</span>
							</li>
							<li>
								<strong>2562</strong>
								<span>tweets</span>
							</li>
						</ul>
					</div><!--/social-box-->

				</div><!--/col-->

              </div>



                <!-- statics end -->



<!-- unused -->
                  <div class="widget-foot">
                    <!-- Footer goes here -->
                  </div>
                </div>
              </div>

            </div>

          </div>
              <!-- project team & activity end -->

          </section>
      </section>
      <!--main content end-->
  </section>
  <!-- container section start -->

  <!-- javascripts -->
  <script src="js/jquery.js"></script>
	<script src="js/jquery-ui-1.10.4.min.js"></script>
  <script src="js/jquery-1.8.3.min.js"></script>
  <script type="text/javascript" src="js/jquery-ui-1.9.2.custom.min.js"></script>
  <!-- bootstrap -->
  <script src="js/bootstrap.min.js"></script>
  <!-- nice scroll -->
  <script src="js/jquery.scrollTo.min.js"></script>
  <script src="js/jquery.nicescroll.js" type="text/javascript"></script>
  <!-- charts scripts -->
  <script src="assets/jquery-knob/js/jquery.knob.js"></script>
  <script src="js/jquery.sparkline.js" type="text/javascript"></script>
  <script src="assets/jquery-easy-pie-chart/jquery.easy-pie-chart.js"></script>
  <script src="js/owl.carousel.js" ></script>
  <!-- jQuery full calendar -->
  <script src="js/fullcalendar.min.js"></script> <!-- Full Google Calendar - Calendar -->
	<script src="assets/fullcalendar/fullcalendar/fullcalendar.js"></script>
  <!--script for this page only-->
  <script src="js/calendar-custom.js"></script>
	<script src="js/jquery.rateit.min.js"></script>
  <!-- custom select -->
  <script src="js/jquery.customSelect.min.js" ></script>
	<script src="assets/chart-master/Chart.js"></script>

  <!--custome script for all page-->
  <script src="js/scripts.js"></script>
  <script src="js/config.js"></script>

  <!-- custom script for this page-->
  <script src="js/sparkline-chart.js"></script>
  <script src="js/easy-pie-chart.js"></script>
	<!-- <script src="js/jquery-jvectormap-1.2.2.min.js"></script>
	<script src="js/jquery-jvectormap-world-mill-en.js"></script> -->
	<script src="js/xcharts.min.js"></script>
	<script src="js/jquery.autosize.min.js"></script>
	<script src="js/jquery.placeholder.min.js"></script>
	<script src="js/gdp-data.js"></script>
	<script src="js/morris.min.js"></script>
	<script src="js/sparklines.js"></script>
	<script src="js/charts.js"></script>
	<script src="js/jquery.slimscroll.min.js"></script>


  <!-- leaflet map -->
  <script src="http://cdn.leafletjs.com/leaflet-0.7.3/leaflet.js"></script>
  <script src="http://api.tiles.mapbox.com/mapbox.js/plugins/leaflet-markercluster/v0.4.0/leaflet.markercluster.js"></script>
  <script src="http://api.tiles.mapbox.com/mapbox.js/plugins/leaflet-locatecontrol/v0.24.0/L.Control.Locate.js"></script>
  <script src="assets/leaflet-groupedlayercontrol/leaflet.groupedlayercontrol.js"></script>
  <script src="assets/leaflet-heatmap/heatmap.js"></script>
  <script src="assets/leaflet-heatmap/leaflet-heatmap.js"></script>
  <script src="js/easy-button.js"></script>

  <script>

      //knob
      $(function() {
        $(".knob").knob({
          'draw' : function () {
            $(this.i).val(this.cv + '%')
          }
        })
      });
      //carousel
      $(document).ready(function() {
          $("#owl-slider").owlCarousel({
              navigation : true,
              slideSpeed : 300,
              paginationSpeed : 400,
              singleItem : true

          });
      });
      //custom select box

      $(function(){
          $('select.styled').customSelect();
      });

	  /* ---------- Map ---------- */
	// $(function(){
	//   $('#map').vectorMap({
	//     map: 'world_mill_en',
	//     series: {
	//       regions: [{
	//         values: gdpData,
	//         scale: ['#000', '#000'],
	//         normalizeFunction: 'polynomial'
	//       }]
	//     },
	// 	backgroundColor: '#eef3f7',
	//     onLabelShow: function(e, el, code){
	//       el.html(el.html()+' (GDP - '+gdpData[code]+')');
	//     }
	//   });
	// });
  $(function(){
    var markerMap = {};
    var map;
    /* Basemap Layers */
    var mapquestOSM = L.tileLayer("http://a.tile.openstreetmap.org/{z}/{x}/{y}.png", {
      maxZoom: 19,
      subdomains: ["otile1", "otile2", "otile3", "otile4"],
      attribution: 'Tiles courtesy of <a href="http://www.mapquest.com/" target="_blank">MapQuest</a> <img src="http://developer.mapquest.com/content/osm/mq_logo.png">. Map data (c) <a href="http://www.openstreetmap.org/" target="_blank">OpenStreetMap</a> contributors, CC-BY-SA.'
    });

    /* Single marker cluster layer to hold all clusters */
    var markerClusters = new L.MarkerClusterGroup({
      spiderfyOnMaxZoom: true,
      showCoverageOnHover: false,
      zoomToBoundsOnClick: true,
      disableClusterinAtZoom: 8
    });

    map = L.map("map", {
      zoom: 8,
      center: [25.0391667, 121.525],
      layers: [mapquestOSM, markerClusters],
      zoomControl: true,
      attributionControl: false
    });

    // Setup map width
    $('#map').width($('.panel-body-map').width());

    // Get Air Quilty Data
    $.getJSON(baseURL + "/api/geojsonAQI", function(data) {
      var listTable;
      var siteMenu = "";
      var geojson = L.geoJson(data, {
        onEachFeature: function (feature, layer) {
          content = "<table class='table table-striped table-bordered table-condensed'>"
            + "<tr><th>測站名稱</th><td>" + feature.properties.SiteName + "監測站"
            + "</td></tr>" + "<tr><th>縣市</th><td>" + feature.properties.County
            + "</td></tr>" + "<tr><th>狀態</th><td>" + feature.properties.Status
            + "</td></tr>" + "<tr><th>資料更新時間</th><td>" + feature.properties.PublishTime
            + "</td></tr>" + "<tr><th>地址</th><td>" + feature.properties.SiteAddres
            + "</td></tr>" + "<table>";
          listTable += "<tr><td>"
            + "<img src=\"img/Taiwan.png\" style=\"height:18px; margin-top:-2px;\"></td>"
            + "<td>" + feature.properties.SiteName + "</td>"
            + "<td>" + feature.properties.PM10 + "</td>"
            + "<td>" + feature.properties['PM2.5'] + "</td>"
            + "<td><div class=\"progress thin\">"
            +  "<div class=\"progress-bar progress-bar-danger\""
            +  " role=\"progressbar\" aria-valuenow=\""+ feature.properties.PSI
            + "\" aria-valuemin=\"0\" aria-valuemax=\"100\" style=\"width: "
            + feature.properties.PSI + "% \"></div>"
            + "<div class=\"progress-bar progress-bar-info\""
            + " role=\"progressbar\" aria-valuenow=\""
            + (100 - feature.properties.PSI) + "\" aria-valuemin=\"0\""
            + " aria-valuemax=\"100\" style=\"width: "
            + (100-feature.properties.PSI) + "%\"></div></div>"
            + "<span class=\"sr-only\">" + feature.properties.PSI + "</span>"
            + "</td></tr>";
          siteMenu += "<li><a class=\"\" href=\"chart-chartjs.html?site="
            + feature.properties.SiteName + "\">"
            + feature.properties.SiteName + "</a></li>";
          layer.bindPopup(content);

          // Click event
          layer.on('click', function (e) {
            $("#box-PSI").html(feature.properties.PSI);
            $("#box-PM10").html(feature.properties.PM10);
            $("#box-PM25").html(feature.properties['PM2.5']);
            $("#box-WBGT").html(feature.properties.WBGT.toFixed(1));

            var url = baseURL + "/api/seriesAQI/" + feature.properties.SiteName;
            $.getJSON(url, function(data) {
              //alert(JSON.stringify(data));
              $("#todayspark1").sparkline(data.PSI.reverse(), {
                  type: 'line',
                  width: '250',
                  height: '30',
                  lineColor: '#999',
                  fillColor: '#ffd4aa'});


              $("#todayspark2").sparkline(data.SO2.reverse(), {
                  type: 'line',
                  width: '250',
                  height: '30',
                  lineColor: '#C5CED6',
                  fillColor: '#ffffaa'});

              $("#todayspark3").sparkline(data.CO.reverse(), {
                  type: 'line',
                  width: '250',
                  height: '30',
                  lineColor: '#436B91',
                  fillColor: '#d4ffaa'});

              $("#todayspark4").sparkline(data.O3.reverse(), {
                  type: 'line',
                  width: '250',
                  height: '30',
                  lineColor: '#486b60',
                  fillColor: '#aaffff'});

              $("#todayspark5").sparkline(data.NO2.reverse(), {
                  type: 'line',
                  width: '250',
                  height: '30',
                  lineColor: '#436B91',
                  fillColor: '#aad4ff'});
            });
          });
        }
      });
      map.on('locationfound', function (e) {
        debugger;
        var radius = e.accuracy / 2;
        var myLocationIcon = new L.icon({iconUrl: 'img/currentLoc.png',iconAnchor:[14, 38]});

        //Button: Back to current
        L.easyButton('fa-globe', function(btn, map){
          console.log("hello tony");
        }).addTo(map); // probably just `map`

			  L.marker(e.latlng, {icon: myLocationIcon}).addTo(map)
				    .bindPopup("You are within " + radius + " meters from this point").openPopup();
			  L.circle(e.latlng, radius).addTo(map);
        $.getJSON(baseURL + "/api/geojsonAQI", function(data) {
          var nearbySiteName, nearbyPSI, nearbyPM10, nearbyPM25, nearbyWBGT, d=300000;
          var geojson = L.geoJson(data, {
            onEachFeature: function (feature, layer) {
                var slatlng = L.latLng(feature.geometry.coordinates[1],feature.geometry.coordinates[0]);
                if(slatlng.distanceTo(e.latlng) < d){
                  nearbySiteName = feature.properties.SiteName;
                  nearbyPSI = feature.properties.PSI;
                  nearbyPM10 = feature.properties.PM10;
                  nearbyPM25 = feature.properties['PM2.5'];
                  nearbyWBGT = feature.properties.WBGT;
                  d = slatlng.distanceTo(e.latlng);
                }
            }
          });

          $('#sitelocation').html("<i class=\"fa fa-laptop\"></i> 觀測站："+nearbySiteName);
          $("#box-PSI").html(nearbyPSI);
          if((parseFloat(nearbyPSI)>51) && (parseFloat(nearbyPSI)<100)){
            $("#box-PSI").css("background-color","#ffd600");
          } else if ((parseFloat(nearbyPSI)>101) && (parseFloat(nearbyPSI)<199)) {
            $("#box-PSI").css("background-color","#ff5252");
          } else if ((parseFloat(nearbyPSI)>200) && (parseFloat(nearbyPSI)<299)) {
            $("#box-PSI").css("background-color","#795548");
          } else if (parseFloat(nearbyPSI)>300) {
            $("#box-PSI").css("background-color","#673ab7");
          }
          $("#box-PM10").html(nearbyPM10);
          if((parseFloat(nearbyPM10)>51) && (parseFloat(nearbyPM10)<150)){
            $("#box-PM10").css("background-color","#ffd600");
          } else if ((parseFloat(nearbyPM10)>151) && (parseFloat(nearbyPM10)<350)) {
            $("#box-PM10").css("background-color","#ff5252");
          } else if ((parseFloat(nearbyPM10)>351) && (parseFloat(nearbyPM10)<420)) {
            $("#box-PM10").css("background-color","#795548");
          } else if (parseFloat(nearbyPM10)>421) {
            $("#box-PM10").css("background-color","#673ab7");
          }
          $("#box-PM25").html(nearbyPM25);
          if((parseFloat(nearbyPM25)>36) && (parseFloat(nearbyPM25)<53)){
            $("#box-PM25").css("background-color","#ffd600");
          } else if ((parseFloat(nearbyPM25)>54) && (parseFloat(nearbyPM25)<64)) {
            $("#box-PM25").css("background-color","#ff5252");
          } else if ((parseFloat(nearbyPM25)>65) && (parseFloat(nearbyPM25)<70)) {
            $("#box-PM25").css("background-color","#795548");
          } else if (parseFloat(nearbyPM25)>71) {
            $("#box-PM25").css("background-color","#673ab7");
          }
          $("#box-WBGT").html(nearbyWBGT.toFixed(1));
          if((parseFloat(nearbyWBGT)>26.7) && (parseFloat(nearbyWBGT)<29.3)){
            $("#box-WBGT").css("background-color","#ffd600");
          } else if ((parseFloat(nearbyWBGT)>29.4) && (parseFloat(nearbyWBGT)<31.0)) {
            $("#box-WBGT").css("background-color","#ff5252");
          } else if ((parseFloat(nearbyWBGT)>31.1) && (parseFloat(nearbyWBGT)<32.1)) {
            $("#box-WBGT").css("background-color","#795548");
          } else if (parseFloat(nearbyWBGT)>32.2) {
            $("#box-WBGT").css("background-color","#673ab7");
          }

          var url = baseURL + "/api/seriesAQI/" + nearbySiteName;
          $.getJSON(url, function(data) {
            //alert(JSON.stringify(data));
            $("#todayspark1").sparkline(data.PSI.reverse(), {
                type: 'line',
                width: '250',
                height: '30',
                lineColor: '#999',
                fillColor: '#ffd4aa'});

            $("#todayspark2").sparkline(data.SO2.reverse(), {
                type: 'line',
                width: '250',
                height: '30',
                lineColor: '#C5CED6',
                fillColor: '#ffffaa'});

            $("#todayspark3").sparkline(data.CO.reverse(), {
                type: 'line',
                width: '250',
                height: '30',
                lineColor: '#436B91',
                fillColor: '#d4ffaa'});

            $("#todayspark4").sparkline(data.O3.reverse(), {
                type: 'line',
                width: '250',
                height: '30',
                lineColor: '#486b60',
                fillColor: '#aaffff'});

            $("#todayspark5").sparkline(data.NO2.reverse(), {
                type: 'line',
                width: '250',
                height: '30',
                lineColor: '#436B91',
                fillColor: '#aad4ff'});
          });
        });
      });

      map.on('locationerror', function(e){
          alert("Sorry, We can not get your current loaction.");
        });
      geojson.addTo(map);
      $('#observeStationList').html(listTable);
      $('#siteMenu').html(siteMenu);
      map.locate({setView: true, maxZoom: 16});


      //Event: Responsive map
      $(window).on('orientationchange pageshow resize', function () {
        $("#map").width($("#map-container").width());
        map.invalidateSize();

      }).trigger('resize');
    });



  });



  </script>

  </body>
</html>
